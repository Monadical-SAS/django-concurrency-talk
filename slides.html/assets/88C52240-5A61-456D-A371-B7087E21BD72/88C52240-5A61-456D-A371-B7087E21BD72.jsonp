local_slide( {"name":"88C52240-5A61-456D-A371-B7087E21BD72","json":{"assets":{"2738A1DDBE8BDC6D7440F5EC03FFE5B7":{"type":"texture","index":0,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/88C52240-5A61-456D-A371-B7087E21BD72.pdf"},"width":1024,"height":768},"564F22F0CDD8DE704C4E7E2084A38F59":{"type":"texture","index":1,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/88C52240-5A61-456D-A371-B7087E21BD72.pdf"},"width":1024,"height":768}},"events":[{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00049229876906403734,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"564F22F0CDD8DE704C4E7E2084A38F59"},{"animations":[{"timeOffset":0,"from":{"scalar":false},"beginTime":0,"repeatCount":0,"fillMode":"both","property":"hidden","autoreverses":false,"duration":0.01,"to":{"scalar":true}}],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"2738A1DDBE8BDC6D7440F5EC03FFE5B7"}]}]},"effects":[],"duration":0.01,"type":"transition","name":"none","objectID":"0"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"Full example using locking","targetRectangle":{"y":80.01035213470459,"x":295.68896484375,"width":432.6220703125,"height":50}},{"text":"def send_money(src, dst, amt):","targetRectangle":{"y":204.46991539001465,"x":65.719337463378906,"width":354.00586626492441,"height":23}},{"text":"    with transaction.atomic():","targetRectangle":{"y":227.46991539001465,"x":65.719337463378906,"width":354.00586626492441,"height":23}},{"text":"        # Lock balance rows, preventing other threads from making changes","targetRectangle":{"y":250.46991539001465,"x":65.719337463378906,"width":861.41427457798272,"height":23}},{"text":"        src_bal = UserBalance.objects.select_for_update().filter(id=src)\\u2028        dst_bal = UserBalance.objects.select_for_update().filter(id=dst)","targetRectangle":{"y":273.46991539001465,"x":65.719337463378906,"width":856.61407903581858,"height":46}},{"text":"        ","targetRectangle":{"y":319.46991539001465,"x":65.719337463378906,"width":94.401564337313175,"height":23}},{"text":"        if src_bal[0].total < amt:","targetRectangle":{"y":342.46991539001465,"x":65.719337463378906,"width":401.20664843358099,"height":23}},{"text":"            raise Exception('Not enough balance to complete transaction')","targetRectangle":{"y":365.46991539001465,"x":65.719337463378906,"width":861.41427457798272,"height":23}},{"text":"        # Update the totals and add a BalanceTransfer log row together","targetRectangle":{"y":411.46991539001465,"x":65.719337463378906,"width":826.01368795149028,"height":23}},{"text":"        BalanceTransfer.objects.create(src=src, dst=dst, amt=amt)","targetRectangle":{"y":434.46991539001465,"x":65.719337463378906,"width":767.01271024066955,"height":23}},{"text":"        src_bal.update(total=F('total') - amt)","targetRectangle":{"y":457.46991539001465,"x":65.719337463378906,"width":542.80899493955076,"height":23}},{"text":"        dst_bal.update(total=F('total') + amt)","targetRectangle":{"y":480.46991539001465,"x":65.719337463378906,"width":542.80899493955076,"height":23}},{"text":"Side benefit: no need to scan entire BalanceTransfer ","targetRectangle":{"y":552.929443359375,"x":216.99510192871094,"width":596.33984375,"height":35}},{"text":"table anymore to get a user's balance","targetRectangle":{"y":587.929443359375,"x":299.72361755371094,"width":424.552734375,"height":35}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00049229876906403734,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"2738A1DDBE8BDC6D7440F5EC03FFE5B7"}]}]}}]}} )